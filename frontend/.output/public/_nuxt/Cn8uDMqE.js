import{_ as L}from"./BKSQtRzV.js";import{_ as N}from"./BbuEuYlL.js";import{_ as M,a as F,b as K,c as j,d as G,e as H}from"./C-hzYLZz.js";import{g as q,j as z,c as T,a as r,b as n,w as t,x as J,y as Y,k as i,q as b,F as C,r as w,n as v,o as f,d as l,t as u,l as E}from"./DsjOer2v.js";import{_ as P}from"./BIk-UJZc.js";import{u as Q,_ as W}from"./Cg97V0GM.js";import"./PBMIlgjC.js";const X={class:"mb-6 flex items-center justify-between"},Z={class:"mb-4 flex flex-wrap gap-3"},h=["value"],de=q({__name:"audit-logs",setup(ee){const V=Q(),g=v([]),y=v(!0),m=v(""),_=v(""),p=v("");async function c(){y.value=!0;try{const o={};m.value&&(o.event_type=m.value),_.value&&(o.date_from=_.value),p.value&&(o.date_to=p.value);const{data:e}=await V.get("/admin/audit-logs",{params:o});g.value=e||[]}catch(o){console.error(o)}finally{y.value=!1}}z(c);function B(o){return o.includes("SUCCESS")?"default":o.includes("TIMEOUT")||o.includes("ERROR")?"destructive":"secondary"}function O(o){return new Date(o).toLocaleString()}function S(o){return o?o.substring(0,8)+"...":"-"}return(o,e)=>{const R=L,k=N,d=j,x=K,$=F,s=H,I=P,U=G,A=M,D=W;return f(),T("div",null,[r("div",X,[e[4]||(e[4]=r("h1",{class:"text-2xl font-bold tracking-tight"},"Audit Logs",-1)),n(R,{variant:"outline",size:"sm",onClick:c},{default:t(()=>[...e[3]||(e[3]=[l("Refresh",-1)])]),_:1})]),r("div",Z,[J(r("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>b(m)?m.value=a:null),onChange:c,class:"rounded-md border border-input bg-background px-3 py-2 text-sm"},[e[5]||(e[5]=r("option",{value:""},"All Events",-1)),(f(),T(C,null,w(["BOOKING_SUCCESS","BOOKING_TIMEOUT","SEAT_LOCKED","SEAT_RELEASED","SYSTEM_ERROR"],a=>r("option",{key:a,value:a},u(a),9,h)),64))],544),[[Y,i(m)]]),n(k,{modelValue:i(_),"onUpdate:modelValue":e[1]||(e[1]=a=>b(_)?_.value=a:null),type:"date",class:"w-auto",placeholder:"From",onChange:c},null,8,["modelValue"]),n(k,{modelValue:i(p),"onUpdate:modelValue":e[2]||(e[2]=a=>b(p)?p.value=a:null),type:"date",class:"w-auto",placeholder:"To",onChange:c},null,8,["modelValue"])]),n(D,null,{default:t(()=>[n(A,null,{default:t(()=>[n($,null,{default:t(()=>[n(x,null,{default:t(()=>[n(d,null,{default:t(()=>[...e[6]||(e[6]=[l("Time",-1)])]),_:1}),n(d,null,{default:t(()=>[...e[7]||(e[7]=[l("Event",-1)])]),_:1}),n(d,null,{default:t(()=>[...e[8]||(e[8]=[l("User",-1)])]),_:1}),n(d,null,{default:t(()=>[...e[9]||(e[9]=[l("Seat",-1)])]),_:1}),n(d,null,{default:t(()=>[...e[10]||(e[10]=[l("Booking",-1)])]),_:1}),n(d,null,{default:t(()=>[...e[11]||(e[11]=[l("Details",-1)])]),_:1})]),_:1})]),_:1}),n(U,null,{default:t(()=>[i(y)?(f(),E(x,{key:0},{default:t(()=>[n(s,{colspan:"6",class:"py-10 text-center text-muted-foreground"},{default:t(()=>[...e[12]||(e[12]=[l("Loading...",-1)])]),_:1})]),_:1})):i(g).length===0?(f(),E(x,{key:1},{default:t(()=>[n(s,{colspan:"6",class:"py-10 text-center text-muted-foreground"},{default:t(()=>[...e[13]||(e[13]=[l("No audit logs found",-1)])]),_:1})]),_:1})):(f(!0),T(C,{key:2},w(i(g),a=>(f(),E(x,{key:a.id},{default:t(()=>[n(s,{class:"whitespace-nowrap text-muted-foreground"},{default:t(()=>[l(u(O(a.createdAt)),1)]),_:2},1024),n(s,null,{default:t(()=>[n(I,{variant:B(a.eventType)},{default:t(()=>[l(u(a.eventType),1)]),_:2},1032,["variant"])]),_:2},1024),n(s,{class:"font-mono text-xs"},{default:t(()=>[l(u(S(a.userId)),1)]),_:2},1024),n(s,null,{default:t(()=>[l(u(a.seatCode||"-"),1)]),_:2},1024),n(s,{class:"font-mono text-xs"},{default:t(()=>[l(u(S(a.bookingId)),1)]),_:2},1024),n(s,{class:"max-w-[200px] truncate text-xs text-muted-foreground"},{default:t(()=>[l(u(JSON.stringify(a.payload)),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})])}}});export{de as default};
